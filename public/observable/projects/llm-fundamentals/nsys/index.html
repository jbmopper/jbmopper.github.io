<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="generator" content="Observable Framework v1.13.3">
<base href="/observable/projects/llm-fundamentals/nsys/">
<title>NSYS Traces | Project Writeup Sandbox</title>

<link rel="preload" as="style" href="../../../_import/astro-bridge-theme.21c55a64.css">
<link rel="stylesheet" type="text/css" href="../../../_import/astro-bridge-theme.21c55a64.css">
<link rel="modulepreload" href="../../../_observablehq/client.cbf2d9f3.js">
<link rel="modulepreload" href="../../../_observablehq/runtime.e080113b.js">
<link rel="modulepreload" href="../../../_observablehq/stdlib.43270668.js">
<link rel="modulepreload" href="../../../_import/embed/nsys.6ef7929e.js">
<link rel="modulepreload" href="../../../_import/components/perf-estimates.d771a94d.js">
<link rel="modulepreload" href="../../../_import/components/data-utils.e2caa41c.js">
<link rel="modulepreload" href="../../../_import/components/dom-utils.363530d4.js">
<link rel="modulepreload" href="../../../_npm/@observablehq/plot@0.6.17/7c43807f.js">
<link rel="modulepreload" href="../../../_npm/d3@7.9.0/e324157d.js">
<link rel="modulepreload" href="../../../_npm/apache-arrow@21.1.0/63de76cd.js">
<link rel="modulepreload" href="../../../_npm/parquet-wasm@0.7.1/68d81b68.js">
<link rel="modulepreload" href="../../../_npm/isoformat@0.2.1/18cbf477.js">
<link rel="modulepreload" href="../../../_npm/interval-tree-1d@1.0.4/53fe8176.js">
<link rel="modulepreload" href="../../../_npm/d3-array@3.2.4/e93ca09f.js">
<link rel="modulepreload" href="../../../_npm/d3-axis@3.0.0/0f2de24d.js">
<link rel="modulepreload" href="../../../_npm/d3-brush@3.0.0/65eb105b.js">
<link rel="modulepreload" href="../../../_npm/d3-chord@3.0.1/7ef8fb2e.js">
<link rel="modulepreload" href="../../../_npm/d3-color@3.1.0/aeb57b94.js">
<link rel="modulepreload" href="../../../_npm/d3-contour@4.0.2/1d2aed74.js">
<link rel="modulepreload" href="../../../_npm/d3-delaunay@6.0.4/5ced1d52.js">
<link rel="modulepreload" href="../../../_npm/d3-dispatch@3.0.1/9ba9c7f3.js">
<link rel="modulepreload" href="../../../_npm/d3-drag@3.0.0/4202580c.js">
<link rel="modulepreload" href="../../../_npm/d3-dsv@3.0.1/9cffc2bd.js">
<link rel="modulepreload" href="../../../_npm/d3-ease@3.0.1/cdd7e898.js">
<link rel="modulepreload" href="../../../_npm/d3-fetch@3.0.1/b4e2ad9a.js">
<link rel="modulepreload" href="../../../_npm/d3-force@3.0.0/5e804d15.js">
<link rel="modulepreload" href="../../../_npm/d3-format@3.1.2/3785bf2d.js">
<link rel="modulepreload" href="../../../_npm/d3-geo@3.1.1/40599fb3.js">
<link rel="modulepreload" href="../../../_npm/d3-hierarchy@3.1.2/e49e792c.js">
<link rel="modulepreload" href="../../../_npm/d3-interpolate@3.0.1/8d1e5425.js">
<link rel="modulepreload" href="../../../_npm/d3-path@3.1.0/20d3f133.js">
<link rel="modulepreload" href="../../../_npm/d3-polygon@3.0.1/7553081f.js">
<link rel="modulepreload" href="../../../_npm/d3-quadtree@3.0.1/0dfd751c.js">
<link rel="modulepreload" href="../../../_npm/d3-random@3.0.1/3c90ee06.js">
<link rel="modulepreload" href="../../../_npm/d3-scale@4.0.2/720b7f0a.js">
<link rel="modulepreload" href="../../../_npm/d3-scale-chromatic@3.1.0/ba24c2e7.js">
<link rel="modulepreload" href="../../../_npm/d3-selection@3.0.0/4d94e5b7.js">
<link rel="modulepreload" href="../../../_npm/d3-shape@3.2.0/6d3a6726.js">
<link rel="modulepreload" href="../../../_npm/d3-time@3.1.0/9f03c579.js">
<link rel="modulepreload" href="../../../_npm/d3-time-format@4.1.0/07c9626f.js">
<link rel="modulepreload" href="../../../_npm/d3-timer@3.0.1/b58a267d.js">
<link rel="modulepreload" href="../../../_npm/d3-transition@3.0.1/004da2ac.js">
<link rel="modulepreload" href="../../../_npm/d3-zoom@3.0.0/b5786b3f.js">
<link rel="modulepreload" href="../../../_npm/tslib@2.8.1/b62a9c4a.js">
<link rel="modulepreload" href="../../../_npm/flatbuffers@25.9.23/c82700c2.js">
<link rel="modulepreload" href="../../../_npm/binary-search-bounds@2.0.5/cbf6ba23.js">
<link rel="modulepreload" href="../../../_npm/internmap@2.0.3/e08981d9.js">
<link rel="modulepreload" href="../../../_npm/delaunator@5.0.1/02d43215.js">
<link rel="modulepreload" href="../../../_npm/robust-predicates@3.0.2/aa00730b.js">
<script type="module">

import {define} from "../../../_observablehq/client.cbf2d9f3.js";
import {registerFile} from "../../../_observablehq/stdlib.43270668.js";

registerFile("../../../data/raw/traces/bad_head_size_nsys.parquet", {"name":"../../../data/raw/traces/bad_head_size_nsys.parquet","path":"../../../_file/data/raw/traces/bad_head_size_nsys.0e5fcf94.parquet","lastModified":1771465633642,"size":699507});
registerFile("../../../data/raw/traces/bandwidth_bound_nsys.parquet", {"name":"../../../data/raw/traces/bandwidth_bound_nsys.parquet","path":"../../../_file/data/raw/traces/bandwidth_bound_nsys.0570a4e8.parquet","lastModified":1771465633645,"size":526034});
registerFile("../../../data/raw/traces/compute_bound_nsys.parquet", {"name":"../../../data/raw/traces/compute_bound_nsys.parquet","path":"../../../_file/data/raw/traces/compute_bound_nsys.9be21553.parquet","lastModified":1771465633647,"size":1020491});
registerFile("../../../data/raw/traces/deep_sequential_nsys.parquet", {"name":"../../../data/raw/traces/deep_sequential_nsys.parquet","path":"../../../_file/data/raw/traces/deep_sequential_nsys.4ed702eb.parquet","lastModified":1771465633653,"size":3186034});
registerFile("../../../data/raw/traces/latency_bound_nsys.parquet", {"name":"../../../data/raw/traces/latency_bound_nsys.parquet","path":"../../../_file/data/raw/traces/latency_bound_nsys.5b9c4edd.parquet","lastModified":1771465633657,"size":1104236});
registerFile("../../../data/raw/traces/misaligned_dims_nsys.parquet", {"name":"../../../data/raw/traces/misaligned_dims_nsys.parquet","path":"../../../_file/data/raw/traces/misaligned_dims_nsys.e0e9fef3.parquet","lastModified":1771465633659,"size":834});
registerFile("../../../data/raw/traces/model_a_nsys.parquet", {"name":"../../../data/raw/traces/model_a_nsys.parquet","path":"../../../_file/data/raw/traces/model_a_nsys.7c95f1f4.parquet","lastModified":1771465633660,"size":294932});
registerFile("../../../data/raw/traces/model_b_nsys.parquet", {"name":"../../../data/raw/traces/model_b_nsys.parquet","path":"../../../_file/data/raw/traces/model_b_nsys.d909797c.parquet","lastModified":1771465633662,"size":1231233});
registerFile("../../../data/raw/traces/vocab_bottleneck_nsys.parquet", {"name":"../../../data/raw/traces/vocab_bottleneck_nsys.parquet","path":"../../../_file/data/raw/traces/vocab_bottleneck_nsys.c6e0b393.parquet","lastModified":1771465633665,"size":509294});
registerFile("../../../data/raw/traces/wide_ffn_nsys.parquet", {"name":"../../../data/raw/traces/wide_ffn_nsys.parquet","path":"../../../_file/data/raw/traces/wide_ffn_nsys.e3df5806.parquet","lastModified":1771465633667,"size":715444});

define({id: "81d1cf6f", outputs: ["renderNsys"], body: async () => {
const {renderNsys} = await import("../../../_import/embed/nsys.6ef7929e.js");

return {renderNsys};
}});

define({id: "842e7c02", inputs: ["renderNsys","display"], body: async (renderNsys,display) => {
display(await(
await renderNsys()
))
}});

</script>
</head>
<body>
<input id="observablehq-sidebar-toggle" type="checkbox" title="Toggle sidebar">
<label id="observablehq-sidebar-backdrop" for="observablehq-sidebar-toggle"></label>
<nav id="observablehq-sidebar">
  <ol>
    <label id="observablehq-sidebar-close" for="observablehq-sidebar-toggle"></label>
    <li class="observablehq-link"><a href="../../../">Project Writeup Sandbox</a></li>
  </ol>
  <ol>
    <li class="observablehq-link"><a href="../../">Projects</a></li>
    <li class="observablehq-link"><a href="../">LLM Fundamentals</a></li>
    <li class="observablehq-link"><a href="../../data-playground/">Data Playground</a></li>
  </ol>
</nav>
<script>{const e=document.querySelector("#observablehq-sidebar"),o=document.querySelector("#observablehq-sidebar-toggle"),r=sessionStorage.getItem("observablehq-sidebar");r?o.checked=r==="true":o.indeterminate=!0;for(const t of document.querySelectorAll("#observablehq-sidebar summary")){const s=t.parentElement;switch(sessionStorage.getItem(`observablehq-sidebar:${t.textContent}`)){case"true":s.open=!0;break;case"false":s.classList.contains("observablehq-section-active")||(s.open=!1);break}}addEventListener("beforeunload",()=>sessionStorage.setItem("observablehq-sidebar-scrolly",`${e.scrollTop}`));const a=sessionStorage.getItem("observablehq-sidebar-scrolly");a!=null&&(e.style.cssText="overflow: hidden;",e.scrollTop=+a,e.style.cssText="");}</script>
<div id="observablehq-center">
<header id="observablehq-header">
<nav class="portfolio-top-links"><a class="portfolio-nav-link" href="../../../" onclick="event.preventDefault(); window.location.assign(window.location.origin + '/');">Home</a><a class="portfolio-nav-link" href="../../" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/');">Projects</a><details id="portfolio-current-project-menu" class="portfolio-project-menu"><summary class="portfolio-nav-link portfolio-project-toggle">LLM Fundamentals</summary><div class="portfolio-project-dropdown"><a class="portfolio-project-item" href="../" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/llm-fundamentals/');">Introduction</a><a class="portfolio-project-item" href="../perf-expected/" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/llm-fundamentals/perf-expected/');">Architecture and Expected Performance Analysis</a><a class="portfolio-project-item" href="../perf-empirical/" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/llm-fundamentals/perf-empirical/');">Benchmarks and Empirical Performance Analysis</a><a class="portfolio-project-item" href="./" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/llm-fundamentals/nsys/');">Nvidia CUDA Nsys Trace Analysis</a><a class="portfolio-project-item" href="../lr-sweep/" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/llm-fundamentals/lr-sweep/');">Learning Parameter Sweeps</a><a class="portfolio-project-item" href="../ablations/" onclick="event.preventDefault(); const mount = window.location.pathname.startsWith('/observable/') ? '/observable' : ''; window.location.assign(window.location.origin + mount + '/projects/llm-fundamentals/ablations/');">Architectural Variations (Ablations)</a></div></details></nav><script>(function(){const path=window.location.pathname.replace(/^\/observable(?=\/|$)/,""); const menu=document.getElementById("portfolio-current-project-menu"); if(menu && /^\/projects(?:\/index\.html)?\/?$/.test(path)){menu.remove();} if(menu){document.addEventListener("click",(event)=>{if(!menu.hasAttribute("open")) return; if(!menu.contains(event.target)) menu.removeAttribute("open");}); document.addEventListener("keydown",(event)=>{if(event.key==="Escape") menu.removeAttribute("open");});} for(const id of ["observablehq-sidebar-toggle","observablehq-sidebar-backdrop","observablehq-sidebar"]){const node=document.getElementById(id); if(node) node.remove();}})();</script>
</header>
<aside id="observablehq-toc" data-selector="h1:not(:first-of-type)[id], h2:first-child[id], :not(h1) + h2[id]">
<nav>
</nav>
</aside>
<main id="observablehq-main" class="observablehq">
<h1 id="nsys-trace-analysis" tabindex="-1"><a class="observablehq-header-anchor" href="#nsys-trace-analysis">NSYS Trace Analysis</a></h1>
<h2 id="introduction" tabindex="-1"><a class="observablehq-header-anchor" href="#introduction">Introduction</a></h2>
<p>Profiling GPU behavior is an important skill for an AI engineering practicioner to posess.  We therefore took the time to run some traces on RTX 4090 GPUs in order to try to observe differences.  NCU profiling was also attempted, however Nvidia performance counters were not available in the containerized environments tests were run in.</p>
<p>Nsys nevertheless provides very fine-grained information on model performance.  Here is a summary of the model specs compared:</p>
<table>
<thead>
<tr>
<th>Config</th>
<th>Batch</th>
<th>Seq</th>
<th>d_model</th>
<th>num_heads</th>
<th>d_head</th>
<th>num_layers</th>
<th>d_ff</th>
<th>FFN Ratio</th>
<th>Design Intent</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>model_a</strong></td>
<td>32</td>
<td>256</td>
<td>768</td>
<td>12</td>
<td>64</td>
<td>2</td>
<td>2048</td>
<td>2.7x</td>
<td>Wide &amp; shallow baseline -- large d_model, few layers</td>
</tr>
<tr>
<td><strong>model_b</strong></td>
<td>32</td>
<td>256</td>
<td>384</td>
<td>12</td>
<td>32</td>
<td>12</td>
<td>1024</td>
<td>2.7x</td>
<td>Narrow &amp; deep baseline -- small d_model, many layers</td>
</tr>
<tr>
<td><strong>latency_bound</strong></td>
<td>1</td>
<td>128</td>
<td>512</td>
<td>8</td>
<td>64</td>
<td>12</td>
<td>1536</td>
<td>3.0x</td>
<td>Minimal batch -- exposes per-step kernel launch overhead, no batching benefit</td>
</tr>
<tr>
<td><strong>misaligned_dims</strong></td>
<td>34</td>
<td>257</td>
<td>514</td>
<td>2</td>
<td>257</td>
<td>6</td>
<td>1538</td>
<td>3.0x</td>
<td>Non-power-of-2 dims -- stresses tensor core alignment, exposes padding waste</td>
</tr>
<tr>
<td><strong>bad_head_size</strong></td>
<td>32</td>
<td>256</td>
<td>672</td>
<td>12</td>
<td>56</td>
<td>6</td>
<td>1792</td>
<td>2.7x</td>
<td>d_head=56 (not 32/64/128) -- misaligned for tensor core tile sizes</td>
</tr>
<tr>
<td><strong>vocab_bottleneck</strong></td>
<td>64</td>
<td>256</td>
<td>512</td>
<td>8</td>
<td>64</td>
<td>4</td>
<td>1536</td>
<td>3.0x</td>
<td>Large vocab (50,257 vs 10,000) -- stresses embedding/LM-head matmuls</td>
</tr>
<tr>
<td><strong>wide_ffn</strong></td>
<td>32</td>
<td>256</td>
<td>768</td>
<td>12</td>
<td>64</td>
<td>6</td>
<td>4096</td>
<td>5.3x</td>
<td>Very wide FFN -- SwiGLU with 3x the usual d_ff, FFN-dominated compute</td>
</tr>
<tr>
<td><strong>bandwidth_bound</strong></td>
<td>256</td>
<td>256</td>
<td>384</td>
<td>6</td>
<td>64</td>
<td>4</td>
<td>1024</td>
<td>2.7x</td>
<td>Huge batch, small model -- memory bandwidth bound (data movement dominates)</td>
</tr>
<tr>
<td><strong>compute_bound</strong></td>
<td>32</td>
<td>256</td>
<td>1536</td>
<td>24</td>
<td>64</td>
<td>8</td>
<td>4096</td>
<td>2.7x</td>
<td>Very large model -- compute bound (GEMM-dominated, tests peak FLOP utilization)</td>
</tr>
<tr>
<td><strong>deep_sequential</strong></td>
<td>32</td>
<td>256</td>
<td>512</td>
<td>8</td>
<td>64</td>
<td>32</td>
<td>1536</td>
<td>3.0x</td>
<td>Very deep -- 32 layers of sequential dependency, tests pipeline bubble effects</td>
</tr>
</tbody>
</table>
<div class="observablehq observablehq--block"><!--:81d1cf6f:--></div>
<div class="observablehq observablehq--block"><observablehq-loading></observablehq-loading><!--:842e7c02:--></div>
</main>
<footer id="observablehq-footer">
<div>Built with <a href="https://observablehq.com/" target="_blank" rel="noopener noreferrer">Observable</a> on <a title="2026-02-19T15:08:46">Feb 19, 2026</a>.</div>
</footer>
</div>
</body>
</html>
