<svg width="1174" height="4288" viewBox="0 0 1174 4288" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="1174" height="4288" fill="#1E1E1E"/>
<rect width="1174" height="4288" fill="white"/>
<rect x="147" y="753" width="912" height="2552" rx="6" stroke="#757575" stroke-width="4" stroke-linecap="round"/>
<rect x="179" y="409" width="192" height="112" rx="6" fill="#F2F2FF" stroke="#D2C7FF" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="232.384" y="470.818">Ebmedding</tspan></text>
<rect x="179" y="121" width="192" height="96" rx="38.4" fill="#EDF5FF" stroke="#B7D3FF" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="226.804" y="174.818">Input Tokens</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="259">[B, S]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="291" y="283">B: {{B}}&#10;</tspan><tspan x="291" y="307">S: {{seq_len}}</tspan></text>
<path d="M277 225C277 223.895 276.105 223 275 223C273.895 223 273 223.895 273 225H275H277ZM273.586 401.914C274.367 402.695 275.633 402.695 276.414 401.914L289.142 389.186C289.923 388.405 289.923 387.139 289.142 386.358C288.361 385.577 287.095 385.577 286.314 386.358L275 397.672L263.686 386.358C262.905 385.577 261.639 385.577 260.858 386.358C260.077 387.139 260.077 388.405 260.858 389.186L273.586 401.914ZM275 225H273V400.5H275H277V225H275Z" fill="#A5A5A5"/>
<rect x="179" y="833" width="192" height="112" rx="6" fill="#FBF0FF" stroke="#F9BBFF" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="235.077" y="894.818">RMS Norm</tspan></text>
<path d="M277 529C277 527.895 276.105 527 275 527C273.895 527 273 527.895 273 529H275H277ZM273.586 825.914C274.367 826.695 275.633 826.695 276.414 825.914L289.142 813.186C289.923 812.405 289.923 811.139 289.142 810.358C288.361 809.577 287.095 809.577 286.314 810.358L275 821.672L263.686 810.358C262.905 809.577 261.639 809.577 260.858 810.358C260.077 811.139 260.077 812.405 260.858 813.186L273.586 825.914ZM275 529H273V824.5H275H277V529H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="435">[V, d_model]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="459">V: {{V}}&#10;</tspan><tspan x="387" y="483">d_model: {{d_model}}&#10;</tspan><tspan x="387" y="507">Size ({{wt_dtype}}): {{emb_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="579">[B, S, d_model]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="291" y="603">Size ({{ft_dtype}}): {{ft_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="865">Weights: [d_model]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="889">Size ({{wt_dtype}}): {{RMS_size}}&#10;</tspan><tspan x="387" y="913">Compute: {{rms_norm_comp}}</tspan></text>
<rect x="179" y="1089" width="192" height="112" rx="6" fill="#FFF0FB" stroke="#FFBEE8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="218.316" y="1150.82">QKV Projection</tspan></text>
<path d="M277 953C277 951.895 276.105 951 275 951C273.895 951 273 951.895 273 953H275H277ZM273.586 1081.91C274.367 1082.7 275.633 1082.7 276.414 1081.91L289.142 1069.19C289.923 1068.41 289.923 1067.14 289.142 1066.36C288.361 1065.58 287.095 1065.58 286.314 1066.36L275 1077.67L263.686 1066.36C262.905 1065.58 261.639 1065.58 260.858 1066.36C260.077 1067.14 260.077 1068.41 260.858 1069.19L273.586 1081.91ZM275 953H273V1080.5H275H277V953H275Z" fill="#A5A5A5"/>
<rect x="179" y="1345" width="192" height="112" rx="6" fill="#FFF0FB" stroke="#FFBEE8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="197.295" y="1406.82">Split QKV and Heads</tspan></text>
<path d="M277 1209C277 1207.9 276.105 1207 275 1207C273.895 1207 273 1207.9 273 1209H275H277ZM273.586 1337.91C274.367 1338.7 275.633 1338.7 276.414 1337.91L289.142 1325.19C289.923 1324.41 289.923 1323.14 289.142 1322.36C288.361 1321.58 287.095 1321.58 286.314 1322.36L275 1333.67L263.686 1322.36C262.905 1321.58 261.639 1321.58 260.858 1322.36C260.077 1323.14 260.077 1324.41 260.858 1325.19L273.586 1337.91ZM275 1209H273V1336.5H275H277V1209H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="1119">WQKV: [d_model, 3&#xb7;d_model]&#x2028;</tspan><tspan x="629.13" y="1143">&#x2028;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="1143">Size ({{wt_dtype}}): {{wqkv_size}}</tspan><tspan x="387" y="1167">Compute: {{QKV_comp}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="414.684" y="1243">&#x2028;</tspan><tspan x="291" y="1267">3&#xb7;d_model: {{3d_model}}&#x2028;</tspan><tspan x="291" y="1291">Size ({{wt_dtype}}): {{qkv_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="1243">[B, S, 3&#xb7;d_model]</tspan></text>
<rect x="179" y="1721" width="192" height="112" rx="6" fill="#FFF0F0" stroke="#FFC0B8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="255.405" y="1782.82">RoPE</tspan></text>
<path d="M277 1465C277 1463.9 276.105 1463 275 1463C273.895 1463 273 1463.9 273 1465H275H277ZM273.586 1713.91C274.367 1714.7 275.633 1714.7 276.414 1713.91L289.142 1701.19C289.923 1700.41 289.923 1699.14 289.142 1698.36C288.361 1697.58 287.095 1697.58 286.314 1698.36L275 1709.67L263.686 1698.36C262.905 1697.58 261.639 1697.58 260.858 1698.36C260.077 1699.14 260.077 1700.41 260.858 1701.19L273.586 1713.91ZM275 1465H273V1712.5H275H277V1465H275Z" fill="#A5A5A5"/>
<rect x="595" y="1721" width="192" height="112" rx="6" fill="#FFF0F0" stroke="#FFC0B8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="671.405" y="1782.82">RoPE</tspan></text>
<path d="M277 1465C277 1463.9 276.105 1463 275 1463C273.895 1463 273 1463.9 273 1465H275H277ZM689.586 1713.91C690.367 1714.7 691.633 1714.7 692.414 1713.91L705.142 1701.19C705.923 1700.41 705.923 1699.14 705.142 1698.36C704.361 1697.58 703.095 1697.58 702.314 1698.36L691 1709.67L679.686 1698.36C678.905 1697.58 677.639 1697.58 676.858 1698.36C676.077 1699.14 676.077 1700.41 676.858 1701.19L689.586 1713.91ZM275 1465H273V1497H275H277V1465H275ZM299 1521V1523H667V1521V1519H299V1521ZM691 1545H689V1712.5H691H693V1545H691ZM667 1521V1523C679.15 1523 689 1532.85 689 1545H691H693C693 1530.64 681.359 1519 667 1519V1521ZM275 1497H273C273 1511.36 284.641 1523 299 1523V1521V1519C286.85 1519 277 1509.15 277 1497H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="1759">S capped to max_seq_len&#x2028;</tspan><tspan x="387" y="1783">Compute: {{RoPE_comp}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="803" y="1759">S capped to max_seq_len&#x2028;</tspan><tspan x="803" y="1783">Compute: {{RoPE_comp}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="427.578" y="1571">&#x2028;</tspan><tspan x="291" y="1595">h: {{h}}&#x2028;</tspan><tspan x="291" y="1619">d_head: {{d_model}}/{{h}} = {{d_head}}&#x2028;</tspan><tspan x="291" y="1643">Size (each) ({{wt_dtype}}): {{head_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="1571">Q: [B, h, S, d_head]</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="842.094" y="1587">&#x2028;</tspan><tspan x="707" y="1611">h: {{h}}&#x2028;</tspan><tspan x="707" y="1635">d_head: {{d_model}}/{{h}} = {{d_head}}&#x2028;</tspan><tspan x="707" y="1659">Size (each) ({{wt_dtype}}): {{head_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="707" y="1587">K: [B, h, S, d_head]</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="842.031" y="1415">&#x2028;</tspan><tspan x="707" y="1439">h: {{h}}&#x2028;</tspan><tspan x="707" y="1463">d_head: {{d_model}}/{{h}} = {{d_head}}&#x2028;</tspan><tspan x="707" y="1487">Size (each) ({{wt_dtype}}): {{head_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="707" y="1415">V: [B, h, S, d_head]</tspan></text>
<rect x="179" y="1977" width="192" height="112" rx="6" fill="#FFF0F0" stroke="#FFC0B8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="254.241" y="2038.82">SDPA</tspan></text>
<path d="M277 1465C277 1463.9 276.105 1463 275 1463C273.895 1463 273 1463.9 273 1465H275H277ZM273.586 1969.91C274.367 1970.7 275.633 1970.7 276.414 1969.91L289.142 1957.19C289.923 1956.41 289.923 1955.14 289.142 1954.36C288.361 1953.58 287.095 1953.58 286.314 1954.36L275 1965.67L263.686 1954.36C262.905 1953.58 261.639 1953.58 260.858 1954.36C260.077 1955.14 260.077 1956.41 260.858 1957.19L273.586 1969.91ZM275 1465H273V1497H275H277V1465H275ZM299 1521V1523H1003V1521V1519H299V1521ZM1027 1545H1025V1881H1027H1029V1545H1027ZM1003 1905V1903H299V1905V1907H1003V1905ZM275 1929H273V1968.5H275H277V1929H275ZM299 1905V1903C284.641 1903 273 1914.64 273 1929H275H277C277 1916.85 286.85 1907 299 1907V1905ZM1027 1881H1025C1025 1893.15 1015.15 1903 1003 1903V1905V1907C1017.36 1907 1029 1895.36 1029 1881H1027ZM1003 1521V1523C1015.15 1523 1025 1532.85 1025 1545H1027H1029C1029 1530.64 1017.36 1519 1003 1519V1521ZM275 1497H273C273 1511.36 284.641 1523 299 1523V1521V1519C286.85 1519 277 1509.15 277 1497H275Z" fill="#A5A5A5"/>
<path d="M277 1841C277 1839.9 276.105 1839 275 1839C273.895 1839 273 1839.9 273 1841H275H277ZM273.586 1969.91C274.367 1970.7 275.633 1970.7 276.414 1969.91L289.142 1957.19C289.923 1956.41 289.923 1955.14 289.142 1954.36C288.361 1953.58 287.095 1953.58 286.314 1954.36L275 1965.67L263.686 1954.36C262.905 1953.58 261.639 1953.58 260.858 1954.36C260.077 1955.14 260.077 1956.41 260.858 1957.19L273.586 1969.91ZM275 1841H273V1968.5H275H277V1841H275Z" fill="#A5A5A5"/>
<path d="M693 1841C693 1839.9 692.105 1839 691 1839C689.895 1839 689 1839.9 689 1841H691H693ZM273.586 1969.91C274.367 1970.7 275.633 1970.7 276.414 1969.91L289.142 1957.19C289.923 1956.41 289.923 1955.14 289.142 1954.36C288.361 1953.58 287.095 1953.58 286.314 1954.36L275 1965.67L263.686 1954.36C262.905 1953.58 261.639 1953.58 260.858 1954.36C260.077 1955.14 260.077 1956.41 260.858 1957.19L273.586 1969.91ZM691 1841H689V1881H691H693V1841H691ZM667 1905V1903H299V1905V1907H667V1905ZM275 1929H273V1968.5H275H277V1929H275ZM299 1905V1903C284.641 1903 273 1914.64 273 1929H275H277C277 1916.85 286.85 1907 299 1907V1905ZM691 1881H689C689 1893.15 679.15 1903 667 1903V1905V1907C681.359 1907 693 1895.36 693 1881H691Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="2039">Compute: {{SDPA_compute}}&#x2028;</tspan><tspan x="387" y="2063"> </tspan><tspan x="399.175" y="2063">Scaled Product: {{QK_compute}}&#x2028;</tspan><tspan x="387" y="2087"> </tspan><tspan x="399.175" y="2087">Softmax: {{softmax_compute}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="1991">Scaled product: [B, h, S, S]&#10;</tspan><tspan x="391.058" y="2063">&#xb7; </tspan><tspan x="391.058" y="2087">&#xb7; </tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" letter-spacing="-0.011em"><tspan x="387" y="2015">Scaled product size: {{sp_size}}&#10;</tspan></text>
<rect x="179" y="2233" width="192" height="112" rx="6" fill="#FFF0F0" stroke="#FFC0B8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="200.642" y="2294.82">Concatenate Heads</tspan></text>
<path d="M277 2097C277 2095.9 276.105 2095 275 2095C273.895 2095 273 2095.9 273 2097H275H277ZM273.586 2225.91C274.367 2226.7 275.633 2226.7 276.414 2225.91L289.142 2213.19C289.923 2212.41 289.923 2211.14 289.142 2210.36C288.361 2209.58 287.095 2209.58 286.314 2210.36L275 2221.67L263.686 2210.36C262.905 2209.58 261.639 2209.58 260.858 2210.36C260.077 2211.14 260.077 2212.41 260.858 2213.19L273.586 2225.91ZM275 2097H273V2224.5H275H277V2097H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="407.121" y="2131">&#x2028;</tspan><tspan x="291" y="2155">Size ({{ft_dtype}}): {{features_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="2131">[B, h, S, d_head]</tspan></text>
<circle cx="275" cy="2704" r="28" fill="#FFF3D9" stroke="#FED529" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="269.672" y="2709.82">+</tspan></text>
<path d="M277 529C277 527.895 276.105 527 275 527C273.895 527 273 527.895 273 529H275H277ZM239.914 2705.41C240.695 2704.63 240.695 2703.37 239.914 2702.59L227.186 2689.86C226.405 2689.08 225.139 2689.08 224.358 2689.86C223.577 2690.64 223.577 2691.91 224.358 2692.69L235.672 2704L224.358 2715.31C223.577 2716.09 223.577 2717.36 224.358 2718.14C225.139 2718.92 226.405 2718.92 227.186 2718.14L239.914 2705.41ZM275 529H273V641H275H277V529H275ZM251 665V663H107V665V667H251V665ZM83 689H81V2680H83H85V689H83ZM107 2704V2706H238.5V2704V2702H107V2704ZM83 2680H81C81 2694.36 92.6406 2706 107 2706V2704V2702C94.8497 2702 85 2692.15 85 2680H83ZM107 665V663C92.6406 663 81 674.641 81 689H83H85C85 676.85 94.8497 667 107 667V665ZM275 641H273C273 653.15 263.15 663 251 663V665V667C265.359 667 277 655.359 277 641H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="399.724" y="2387">&#x2028;</tspan><tspan x="291" y="2411">Size ({{ft_dtype}}): {{features_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="2387">[B, S, d_model]</tspan></text>
<rect x="179" y="2855" width="192" height="112" rx="6" fill="#FFF3D9" stroke="#FED529" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="235.077" y="2916.82">RMS Norm</tspan></text>
<path d="M277 2740C277 2738.9 276.105 2738 275 2738C273.895 2738 273 2738.9 273 2740H275H277ZM273.586 2847.91C274.367 2848.7 275.633 2848.7 276.414 2847.91L289.142 2835.19C289.923 2834.41 289.923 2833.14 289.142 2832.36C288.361 2831.58 287.095 2831.58 286.314 2832.36L275 2843.67L263.686 2832.36C262.905 2831.58 261.639 2831.58 260.858 2832.36C260.077 2833.14 260.077 2834.41 260.858 2835.19L273.586 2847.91ZM275 2740H273V2846.5H275H277V2740H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="2887">Weights: [d_model]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="2911">Size ({{wt_dtype}}): {{RMS_size}}&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="2935">Compute: {{rms_norm_comp}}</tspan></text>
<rect x="179" y="3090" width="192" height="112" rx="6" fill="#FFF3D9" stroke="#FED529" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="226.956" y="3151.82">SWiGLU FFN</tspan></text>
<path d="M277 2975C277 2973.9 276.105 2973 275 2973C273.895 2973 273 2973.9 273 2975H275H277ZM273.586 3082.91C274.367 3083.7 275.633 3083.7 276.414 3082.91L289.142 3070.19C289.923 3069.41 289.923 3068.14 289.142 3067.36C288.361 3066.58 287.095 3066.58 286.314 3067.36L275 3078.67L263.686 3067.36C262.905 3066.58 261.639 3066.58 260.858 3067.36C260.077 3068.14 260.077 3069.41 260.858 3070.19L273.586 3082.91ZM275 2975H273V3081.5H275H277V2975H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="583.881" y="3116">&#x2028;</tspan><tspan x="387" y="3140">d_ff: {{d_ff}}&#x2028;</tspan><tspan x="387" y="3164">Size ({{wt_dtype}}): {{swiglu_size}}&#x2028;</tspan><tspan x="387" y="3188">Compute: {{swiglu_comp}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="3116">Weights: 3&#xb7;[d_model, d_ff]</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="399.724" y="3244">&#x2028;</tspan><tspan x="291" y="3268">Size ({{ft_dtype}}): {{features_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="3244">[B, S, d_model]</tspan></text>
<circle cx="275" cy="3403" r="28" fill="#FCFCCA" stroke="#E0E0A3" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="269.672" y="3408.82">+</tspan></text>
<path d="M277 3210C277 3208.9 276.105 3208 275 3208C273.895 3208 273 3208.9 273 3210H275H277ZM273.586 3367.91C274.367 3368.7 275.633 3368.7 276.414 3367.91L289.142 3355.19C289.923 3354.41 289.923 3353.14 289.142 3352.36C288.361 3351.58 287.095 3351.58 286.314 3352.36L275 3363.67L263.686 3352.36C262.905 3351.58 261.639 3351.58 260.858 3352.36C260.077 3353.14 260.077 3354.41 260.858 3355.19L273.586 3367.91ZM275 3210H273V3366.5H275H277V3210H275Z" fill="#A5A5A5"/>
<path d="M277 529C277 527.895 276.105 527 275 527C273.895 527 273 527.895 273 529H275H277ZM239.914 3404.41C240.695 3403.63 240.695 3402.37 239.914 3401.59L227.186 3388.86C226.405 3388.08 225.139 3388.08 224.358 3388.86C223.577 3389.64 223.577 3390.91 224.358 3391.69L235.672 3403L224.358 3414.31C223.577 3415.09 223.577 3416.36 224.358 3417.14C225.139 3417.92 226.405 3417.92 227.186 3417.14L239.914 3404.41ZM275 529H273V641H275H277V529H275ZM251 665V663H107V665V667H251V665ZM83 689H81V3379H83H85V689H83ZM107 3403V3405H238.5V3403V3401H107V3403ZM83 3379H81C81 3393.36 92.6406 3405 107 3405V3403V3401C94.8497 3401 85 3391.15 85 3379H83ZM107 665V663C92.6406 663 81 674.641 81 689H83H85C85 676.85 94.8497 667 107 667V665ZM275 641H273C273 653.15 263.15 663 251 663V665V667C265.359 667 277 655.359 277 641H275Z" fill="#A5A5A5"/>
<rect x="179" y="3559" width="192" height="112" rx="6" fill="#FCFCCA" stroke="#E0E0A3" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="235.077" y="3620.82">RMS Norm</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="3591">Weights: [d_model]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="3615">Size ({{wt_dtype}}): {{RMS_size}}&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="3639">Compute: {{rms_norm_comp}}</tspan></text>
<path d="M277 3439C277 3437.9 276.105 3437 275 3437C273.895 3437 273 3437.9 273 3439H275H277ZM273.586 3551.91C274.367 3552.7 275.633 3552.7 276.414 3551.91L289.142 3539.19C289.923 3538.41 289.923 3537.14 289.142 3536.36C288.361 3535.58 287.095 3535.58 286.314 3536.36L275 3547.67L263.686 3536.36C262.905 3535.58 261.639 3535.58 260.858 3536.36C260.077 3537.14 260.077 3538.41 260.858 3539.19L273.586 3551.91ZM275 3439H273V3550.5H275H277V3439H275Z" fill="#A5A5A5"/>
<rect x="179" y="3815" width="192" height="112" rx="6" fill="#FCFCCA" stroke="#E0E0A3" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="241.52" y="3876.82">LM Head</tspan></text>
<path d="M277 3679C277 3677.9 276.105 3677 275 3677C273.895 3677 273 3677.9 273 3679H275H277ZM273.586 3807.91C274.367 3808.7 275.633 3808.7 276.414 3807.91L289.142 3795.19C289.923 3794.41 289.923 3793.14 289.142 3792.36C288.361 3791.58 287.095 3791.58 286.314 3792.36L275 3803.67L263.686 3792.36C262.905 3791.58 261.639 3791.58 260.858 3792.36C260.077 3793.14 260.077 3794.41 260.858 3795.19L273.586 3807.91ZM275 3679H273V3806.5H275H277V3679H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="3841">Weights: [V, d_model]&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="3865">Size ({{wt_dtype}}): {{lm_head_size}}&#10;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="3889">Compute: {{lm_comp}}</tspan></text>
<rect x="179" y="4071" width="192" height="96" rx="38.4" fill="#FCFCCA" stroke="#E0E0A3" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="223.923" y="4124.82">Output Logits</tspan></text>
<path d="M277 3935C277 3933.9 276.105 3933 275 3933C273.895 3933 273 3933.9 273 3935H275H277ZM273.586 4063.91C274.367 4064.7 275.633 4064.7 276.414 4063.91L289.142 4051.19C289.923 4050.41 289.923 4049.14 289.142 4048.36C288.361 4047.58 287.095 4047.58 286.314 4048.36L275 4059.67L263.686 4048.36C262.905 4047.58 261.639 4047.58 260.858 4048.36C260.077 4049.14 260.077 4050.41 260.858 4051.19L273.586 4063.91ZM275 3935H273V4062.5H275H277V3935H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="345.17" y="3969">&#x2028;</tspan><tspan x="291" y="3993">Size ({{ft_dtype}}): {{output_size}}</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="291" y="3969">[B, S, V]</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="499" y="734">Transformer Blocks: {{n_blocks}}</tspan></text>
<rect x="179" y="2463" width="192" height="112" rx="6" fill="#FFF0F0" stroke="#FFC0B8" stroke-width="4" stroke-linecap="round"/>
<text fill="black" fill-opacity="0.8" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="209.088" y="2524.82">Output Projection</tspan></text>
<path d="M277 2353C277 2351.9 276.105 2351 275 2351C273.895 2351 273 2351.9 273 2353H275H277ZM273.586 2455.91C274.367 2456.7 275.633 2456.7 276.414 2455.91L289.142 2443.19C289.923 2442.41 289.923 2441.14 289.142 2440.36C288.361 2439.58 287.095 2439.58 286.314 2440.36L275 2451.67L263.686 2440.36C262.905 2439.58 261.639 2439.58 260.858 2440.36C260.077 2441.14 260.077 2442.41 260.858 2443.19L273.586 2455.91ZM275 2353H273V2454.5H275H277V2353H275Z" fill="#A5A5A5"/>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="bold" letter-spacing="-0.011em"><tspan x="387" y="2501">O: [d_model, d_model]&#x2028;</tspan><tspan x="599.579" y="2525">&#x2028;</tspan></text>
<text fill="#1E1E1E" xml:space="preserve" style="white-space: pre" font-family="Inter" font-size="16" font-weight="500" letter-spacing="-0.011em"><tspan x="387" y="2525">Size ({{wt_dtype}}): {{o_size}}</tspan><tspan x="387" y="2549">Compute: {{o_proj_comp}}</tspan></text>
<path d="M277 2583C277 2581.9 276.105 2581 275 2581C273.895 2581 273 2581.9 273 2583H275H277ZM273.586 2668.91C274.367 2669.7 275.633 2669.7 276.414 2668.91L289.142 2656.19C289.923 2655.41 289.923 2654.14 289.142 2653.36C288.361 2652.58 287.095 2652.58 286.314 2653.36L275 2664.67L263.686 2653.36C262.905 2652.58 261.639 2652.58 260.858 2653.36C260.077 2654.14 260.077 2655.41 260.858 2656.19L273.586 2668.91ZM275 2583H273V2667.5H275H277V2583H275Z" fill="#B3B3B3"/>
</svg>
