---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import ObservableEmbed from "../../../components/ObservableEmbed.astro";
---

<BaseLayout
  title="Deep Learning Fundamentals | jbmopper.github.io"
  description="Transformer implementation, profiling, and benchmark analysis"
>
  <article class="project-root">
    <header class="panel">
      <p class="eyebrow">Project</p>
      <h1>Deep Learning Fundamentals</h1>
      <p>
        Technical deep dive into transformer implementation, training behavior, profiling traces, and architecture
        experiments.
      </p>
      <nav>
        <a href="/">Back home</a>
        <a href="/projects/deep-learning-fundamentals/notes/">Notes route</a>
      </nav>
    </header>

    <section class="panel">
      <h2>NSYS Trace Explorer</h2>
      <p>Kernel and memory event diagnostics exported from Observable and mounted in Astro.</p>
      <ObservableEmbed
        modulePath="/observable/embed/nsys.js"
        exportName="renderNsys"
        options={{initialTraces: ["model_a", "model_b", "misaligned_dims"], timelineBucketMs: 5, topK: 8}}
      />
    </section>

    <section class="panel">
      <h2>Benchmark Explorer</h2>
      <p>Filtered benchmark narrative with workload and model-slice controls.</p>
      <ObservableEmbed
        modulePath="/observable/embed/benchmarks.js"
        exportName="renderBenchmarks"
        options={{datasets: ["micro", "train"], metric: "latency_ms", topN: 10}}
      />
    </section>

    <section class="panel">
      <h2>Ablations</h2>
      <p>Ablation study results and history comparison.</p>
      <ObservableEmbed
        modulePath="/observable/embed/ablations.js"
        exportName="renderAblations"
        options={{}}
      />
    </section>

    <section class="panel">
      <h2>LR Sweep</h2>
      <p>Learning rate sweep analysis and loss thresholds.</p>
      <ObservableEmbed
        modulePath="/observable/embed/lr-sweep.js"
        exportName="renderLrSweep"
        options={{}}
      />
    </section>

    <section class="panel">
      <h2>Perf Empirical</h2>
      <p>Empirical performance comparison (MPS vs GPU, training and micro).</p>
      <ObservableEmbed
        modulePath="/observable/embed/perf-empirical.js"
        exportName="renderPerfEmpirical"
        options={{}}
      />
    </section>

    <section class="panel">
      <h2>Perf Expected</h2>
      <p>Expected performance from model specs and FLOP/memory estimates.</p>
      <ObservableEmbed
        modulePath="/observable/embed/perf-expected.js"
        exportName="renderPerfExpected"
        options={{}}
      />
    </section>
  </article>
</BaseLayout>

<style>
  .project-root {
    display: grid;
    gap: 1rem;
  }

  .panel {
    border: 1px solid var(--stroke);
    border-radius: 14px;
    padding: 1.1rem;
    background: color-mix(in srgb, var(--surface) 82%, transparent);
  }

  .eyebrow {
    margin: 0;
    color: var(--accent);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  h1 {
    margin: 0.4rem 0 0.75rem;
    font-size: clamp(1.7rem, 3vw, 2.5rem);
  }

  p {
    color: var(--text-1);
  }

  nav {
    display: flex;
    gap: 0.75rem;
    flex-wrap: wrap;
  }

  nav a {
    color: var(--text-0);
    text-decoration: none;
    border: 1px solid var(--stroke);
    border-radius: 999px;
    padding: 0.4rem 0.8rem;
  }

  nav a:hover {
    border-color: var(--accent);
  }

  section h2 {
    margin: 0 0 0.6rem;
  }

  section p {
    margin-top: 0;
  }
</style>
